var e,n,t,o,r=require("phoenix");function i(){return i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},i.apply(this,arguments)}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}exports.Network=void 0,(e=exports.Network||(exports.Network={})).MAINNET="mainnet",e.TESTNET="testnet",exports.EventType=void 0,(n=exports.EventType||(exports.EventType={})).ITEM_METADATA_UPDATED="item_metadata_updated",n.ITEM_LISTED="item_listed",n.ITEM_SOLD="item_sold",n.ITEM_TRANSFERRED="item_transferred",n.ITEM_RECEIVED_OFFER="item_received_offer",n.ITEM_RECEIVED_BID="item_received_bid",n.ITEM_CANCELLED="item_cancelled",exports.LogLevel=void 0,(t=exports.LogLevel||(exports.LogLevel={}))[t.DEBUG=20]="DEBUG",t[t.INFO=30]="INFO",t[t.WARN=40]="WARN",t[t.ERROR=50]="ERROR";var c=((o={})[exports.Network.MAINNET]="wss://stream.openseabeta.com/socket",o[exports.Network.TESTNET]="wss://testnets-stream.openseabeta.com/socket",o);exports.OpenSeaStreamClient=/*#__PURE__*/function(){function e(e){var n=this,t=e.network,o=void 0===t?exports.Network.MAINNET:t,a=e.token,u=e.apiUrl,l=e.connectOptions,f=e.logLevel,E=void 0===f?exports.LogLevel.INFO:f,d=e.onError,v=void 0===d?function(e){return n.error(e)}:d;this.socket=void 0,this.channels=void 0,this.logLevel=void 0,this.connect=function(){n.debug("Connecting to socket"),n.socket.connect()},this.disconnect=function(e){return void 0===e&&(e=function(){return n.info("Succesfully disconnected from socket")}),n.channels.clear(),n.socket.disconnect(e)},this.createChannel=function(e){var t=n.socket.channel(e);return t.join().receive("ok",function(){return n.info('Successfully joined channel "'+e+'"')}).receive("error",function(){return n.error('Failed to join channel "'+e+'"')}),n.channels.set(e,t),t},this.getChannel=function(e){var t=n.channels.get(e);return t||(n.debug('Creating channel for topic: "'+e+'"'),t=n.createChannel(e)),t},this.on=function(e,t,o){n.socket.connect();var r="collection:"+t;n.debug("Fetching channel "+r);var i=n.getChannel(r);return n.debug("Subscribing to "+e+" events on "+r),i.on(e,o),function(){n.debug("Unsubscribing from "+e+" events on "+r),i.leave().receive("ok",function(){n.channels.delete(r),n.info('Succesfully left channel "'+r+'" listening for '+e)})}},this.onItemMetadataUpdated=function(e,t){return n.debug('Listening for item metadata updates on "'+e+'"'),n.on(exports.EventType.ITEM_METADATA_UPDATED,e,t)},this.onItemCancelled=function(e,t){return n.debug('Listening for item cancellations on "'+e+'"'),n.on(exports.EventType.ITEM_CANCELLED,e,t)},this.onItemListed=function(e,t){return n.debug('Listening for item listings on "'+e+'"'),n.on(exports.EventType.ITEM_LISTED,e,t)},this.onItemSold=function(e,t){return n.debug('Listening for item sales on "'+e+'"'),n.on(exports.EventType.ITEM_SOLD,e,t)},this.onItemTransferred=function(e,t){return n.debug('Listening for item transfers on "'+e+'"'),n.on(exports.EventType.ITEM_TRANSFERRED,e,t)},this.onItemReceivedOffer=function(e,t){return n.debug('Listening for item offers on "'+e+'"'),n.on(exports.EventType.ITEM_RECEIVED_OFFER,e,t)},this.onItemReceivedBid=function(e,t){return n.debug('Listening for item bids on "'+e+'"'),n.on(exports.EventType.ITEM_RECEIVED_BID,e,t)},this.onEvents=function(e,t,o){var r=t.map(function(t){return n.on(t,e,o)});return function(){for(var e,n=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return s(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,n):void 0}}(e))){t&&(e=t);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(r);!(e=n()).done;)(0,e.value)()}};var p="undefined"!=typeof window?window.WebSocket:void 0;this.socket=new r.Socket(u||c[o],i({params:{token:a},transport:p},l)),this.socket.onError(v),this.channels=new Map,this.logLevel=E}var n=e.prototype;return n.debug=function(e){this.logLevel<=exports.LogLevel.DEBUG&&console.debug("[DEBUG]: "+e)},n.info=function(e){this.logLevel<=exports.LogLevel.INFO&&console.info("[INFO]: "+e)},n.warn=function(e){this.logLevel<=exports.LogLevel.WARN&&console.warn("[WARN]: "+e)},n.error=function(e){this.logLevel<=exports.LogLevel.ERROR&&console.error("[ERROR]: "+e)},e}();
//# sourceMappingURL=index.cjs.map
